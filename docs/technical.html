<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Reference - Aviator Docs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="style.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <style>
        /* Specific overrides */
        .endpoint-card {
            @apply bg-slate-800 border border-slate-700 rounded-lg overflow-hidden mb-8 shadow-lg;
        }

        .endpoint-header {
            @apply bg-slate-900/50 p-4 border-b border-slate-700 flex items-center gap-4;
        }

        .method {
            @apply font-bold px-3 py-1 rounded text-white text-xs uppercase tracking-wide;
        }

        .get {
            @apply bg-green-600;
        }

        .post {
            @apply bg-blue-600;
        }

        .url {
            @apply font-mono text-cyan-300;
        }
    </style>
</head>

<body class="min-h-screen flex">

    <!-- Sidebar -->
    <aside class="w-64 fixed h-full overflow-y-auto z-20">
        <div class="p-6 mb-4 text-center">
            <a href="index.html" class="block hover:opacity-80 transition-opacity">
                <h2
                    class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500 tracking-widest uppercase mb-1">
                    Aviator</h2>
                <p class="text-xs text-slate-500 font-mono">DOCS v2.0</p>
            </a>
        </div>
        <nav class="px-4 space-y-1">
            <a href="index.html" class="sidebar-link">Overview</a>
            <a href="user_guide.html" class="sidebar-link">User Guide</a>
            <a href="architecture.html" class="sidebar-link">Architecture</a>
            <a href="technical.html" class="sidebar-link active">Technical API</a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="ml-64 p-12 w-full">
        <header class="mb-12 text-center border-b border-slate-800 pb-10">
            <div class="inline-block p-3 rounded-full bg-blue-500/10 mb-4">
                <i class="fas fa-code text-4xl text-blue-400"></i>
            </div>
            <h1>Technical Reference</h1>
            <p class="text-xl text-slate-400 max-w-2xl mx-auto">Complete API documentation and internal code structure
                for the Wails-based implementation.</p>
        </header>

        <div class="grid grid-cols-1 xl:grid-cols-3 gap-10">
            <!-- Left Column: API -->
            <div class="xl:col-span-2">
                <section>
                    <h2><i class="fas fa-network-wired text-green-500"></i> REST API Endpoints</h2>
                    <p class="text-sm text-slate-400 mb-6">The embedded HTTP server listens on <code>port 8000</code> by
                        default. All responses are JSON unless serving static files.</p>

                    <!-- Apps List -->
                    <div class="endpoint-card">
                        <div class="endpoint-header">
                            <span class="method get">GET</span>
                            <span class="url">/api/apps</span>
                        </div>
                        <div class="p-6">
                            <p>Retrieves the registry of all configured applications.</p>
                            <div class="mt-4">
                                <span class="text-xs text-slate-500 uppercase font-bold">Response 200 OK</span>
                                <pre class="!m-0 !mt-2 rounded-lg !text-xs"><code class="language-json">[
  {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "Steam",
    "path": "C:\\Program Files\\Steam\\steam.exe",
    "args": "-bigpicture"
  },
  {
    "id": "6ba7b810-9dad-11d1-80b4-00c04fd430c8",
    "name": "Chrome",
    "path": "C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe",
    "args": "--incognito"
  }
]</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- Process Status -->
                    <div class="endpoint-card">
                        <div class="endpoint-header">
                            <span class="method get">GET</span>
                            <span class="url">/api/monitoring/status</span>
                        </div>
                        <div class="p-6">
                            <p>Returns a dictionary mapping App IDs to their running status (boolean).</p>
                            <div class="mt-4">
                                <span class="text-xs text-slate-500 uppercase font-bold">Response 200 OK</span>
                                <pre class="!m-0 !mt-2 rounded-lg !text-xs"><code class="language-json">{
  "550e8400-e29b-41d4-a716-446655440000": true,
  "6ba7b810-9dad-11d1-80b4-00c04fd430c8": false
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- Launch -->
                    <div class="endpoint-card">
                        <div class="endpoint-header">
                            <span class="method post">POST</span>
                            <span class="url">/api/launch/{app_id}</span>
                        </div>
                        <div class="p-6">
                            <p>Executes the application identified by <code>app_id</code> on the host machine. Uses Go's
                                <code>os/exec</code> to spawn a detached process.
                            </p>
                            <div class="grid grid-cols-2 gap-4 mt-4">
                                <div class="bg-slate-900/50 p-3 rounded border border-slate-700/50">
                                    <span class="text-green-500 font-bold block text-xs">200 OK</span>
                                    <span class="text-xs text-slate-400">Application launched successfully</span>
                                    <pre
                                        class="!m-0 !mt-2 rounded !text-xs"><code class="language-json">{"status": "launched"}</code></pre>
                                </div>
                                <div class="bg-slate-900/50 p-3 rounded border border-slate-700/50">
                                    <span class="text-red-500 font-bold block text-xs">404 Not Found</span>
                                    <span class="text-xs text-slate-400">Invalid ID or file missing</span>
                                    <pre
                                        class="!m-0 !mt-2 rounded !text-xs"><code class="language-json">{"error": "app not found"}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Server Info -->
                    <div class="endpoint-card">
                        <div class="endpoint-header">
                            <span class="method get">GET</span>
                            <span class="url">/api/info</span>
                        </div>
                        <div class="p-6">
                            <p>Returns server metadata and status information.</p>
                            <div class="mt-4">
                                <span class="text-xs text-slate-500 uppercase font-bold">Response 200 OK</span>
                                <pre class="!m-0 !mt-2 rounded-lg !text-xs"><code class="language-json">{
  "version": "2.0.0",
  "platform": "windows",
  "apps_count": 5,
  "server_time": 1673045823
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- Static Files -->
                    <div class="endpoint-card">
                        <div class="endpoint-header">
                            <span class="method get">GET</span>
                            <span class="url">/</span>
                        </div>
                        <div class="p-6">
                            <p>Serves the embedded web client (SPA) for remote access.</p>
                            <div class="mt-4 bg-slate-900/50 p-3 rounded border border-slate-700">
                                <span class="text-sm text-slate-300">All static files are embedded in the binary using
                                    Go's <code>embed</code> package. No external files required.</span>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="mt-12">
                    <h2><i class="fas fa-exchange-alt text-purple-500"></i> Wails Bindings (Go ↔ JavaScript)</h2>
                    <p class="text-sm text-slate-400 mb-6">The desktop app uses Wails to expose Go methods to the Vue
                        frontend. These are NOT HTTP endpoints—they're direct function calls.</p>

                    <div class="space-y-6">
                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">GetApps() → []App</h3>
                            <p class="text-sm">Returns all configured applications. Called on component mount to
                                populate the app list.</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">AddApp(name, path, args) → App</h3>
                            <p class="text-sm">Adds a new application to the config. Returns the created app with
                                generated UUID.</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">UpdateApp(id, name, path, args) → bool
                            </h3>
                            <p class="text-sm">Updates an existing application. Returns true on success.</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">RemoveApp(id) → void</h3>
                            <p class="text-sm">Removes an application from the configuration.</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">GetProcessStatuses() → map[string]bool
                            </h3>
                            <p class="text-sm">Returns a map of App IDs to running status. Used for real-time LED
                                indicators.</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">StartServer() → error</h3>
                            <p class="text-sm">Starts the HTTP server and mDNS discovery service. Returns error if
                                server is already running.</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">StopServer() → error</h3>
                            <p class="text-sm">Gracefully shuts down the HTTP server and discovery service.</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">GetServerInfo() → ServerInfo</h3>
                            <p class="text-sm">Returns server status (running/stopped), local URL, and network URL with
                                IP address.</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">GetSettings() → Settings</h3>
                            <p class="text-sm">Retrieves global application preferences (Auto-Start, etc.).</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">UpdateSettings(s) → error</h3>
                            <p class="text-sm">Persists settings to JSON and applies system changes (e.g., Windows
                                Registry for auto-start).</p>
                        </div>

                        <div class="card border-purple-500/30">
                            <h3 class="!mt-0 text-sm font-mono text-purple-300">SelectFile() → string</h3>
                            <p class="text-sm">Opens a native Windows file dialog for selecting executables. Returns the
                                selected file path.</p>
                        </div>
                    </div>
                </section>
            </div>

            <!-- Right Column: Code Structure -->
            <div class="xl:col-span-1">
                <section>
                    <h2><i class="fas fa-sitemap text-yellow-500"></i> Codebase</h2>

                    <div class="space-y-6">
                        <div>
                            <h3 class="!mt-2 !text-base flex items-center gap-2 text-slate-200">
                                <i class="fas fa-file-code text-blue-500"></i> main.go
                            </h3>
                            <p class="text-xs text-slate-400"><strong>Role:</strong> Entry Point & Wails App</p>
                            <div class="bg-slate-800 p-3 rounded text-xs border border-slate-700 mt-2">
                                <ul class="list-disc list-inside space-y-1 text-slate-300">
                                    <li>Initializes config manager, server, and discovery</li>
                                    <li>Creates Wails app with Vue frontend</li>
                                    <li>Binds Go methods to JavaScript</li>
                                    <li>Initializes application window and lifecycle</li>
                                </ul>
                            </div>
                        </div>

                        <div>
                            <h3 class="!mt-6 !text-base flex items-center gap-2 text-slate-200">
                                <i class="fas fa-plug text-cyan-500"></i> app.go
                            </h3>
                            <p class="text-xs text-slate-400"><strong>Role:</strong> Wails Bindings</p>
                            <div class="bg-slate-800 p-3 rounded text-xs border border-slate-700 mt-2">
                                <p class="mb-2">Exposes all Go methods to the Vue frontend. Handles startup/shutdown
                                    lifecycle.</p>
                                <code
                                    class="block bg-slate-900 p-2 rounded text-blue-300">struct App { config, server, discovery }</code>
                            </div>
                        </div>

                        <div>
                            <h3 class="!mt-6 !text-base flex items-center gap-2 text-slate-200">
                                <i class="fas fa-server text-green-500"></i> internal/server/
                            </h3>
                            <p class="text-xs text-slate-400"><strong>Role:</strong> HTTP Server</p>
                            <div class="bg-slate-800 p-3 rounded text-xs border border-slate-700 mt-2">
                                <ul class="list-disc list-inside space-y-1 text-slate-300">
                                    <li>Serves static files from embedded FS</li>
                                    <li>REST API handlers for /api/apps, /api/launch</li>
                                    <li>Graceful shutdown with context.Context</li>
                                </ul>
                            </div>
                        </div>

                        <div>
                            <h3 class="!mt-6 !text-base flex items-center gap-2 text-slate-200">
                                <i class="fas fa-database text-purple-500"></i> internal/config/
                            </h3>
                            <p class="text-xs text-slate-400"><strong>Role:</strong> Configuration Manager</p>
                            <div class="bg-slate-800 p-3 rounded text-xs border border-slate-700 mt-2">
                                <p>JSON persistence: <code>config.json</code> (Apps) and <code>settings.json</code>
                                    (Preferences) in <code>%LOCALAPPDATA%/Aviator/</code>.</p>
                            </div>
                        </div>

                        <div>
                            <h3 class="!mt-6 !text-base flex items-center gap-2 text-slate-200">
                                <i class="fas fa-rocket text-red-500"></i> internal/launcher/
                            </h3>
                            <p class="text-xs text-slate-400"><strong>Role:</strong> Process Execution</p>
                            <div class="bg-slate-800 p-3 rounded text-xs border border-slate-700 mt-2">
                                <p class="mb-2">Uses <code>exec.Command()</code> with detached processes.</p>
                                <code
                                    class="block bg-slate-900 p-2 rounded text-blue-300">cmd.SysProcAttr = &syscall.SysProcAttr{CreationFlags: CREATE_NEW_PROCESS_GROUP}</code>
                            </div>
                        </div>

                        <div>
                            <h3 class="!mt-6 !text-base flex items-center gap-2 text-slate-200">
                                <i class="fas fa-microchip text-yellow-500"></i> internal/processmon/
                            </h3>
                            <p class="text-xs text-slate-400"><strong>Role:</strong> Process Monitoring</p>
                            <div class="bg-slate-800 p-3 rounded text-xs border border-slate-700 mt-2">
                                <p class="mb-2">Uses WMI to query running processes and map them to configured apps.</p>
                            </div>
                        </div>

                        <div>
                            <h3 class="!mt-6 !text-base flex items-center gap-2 text-slate-200">
                                <i class="fab fa-vuejs text-green-400"></i> frontend/src/
                            </h3>
                            <p class="text-xs text-slate-400"><strong>Role:</strong> Vue 3 UI</p>
                            <div class="bg-slate-800 p-3 rounded text-xs border border-slate-700 mt-2">
                                <ul class="list-disc list-inside space-y-1 text-slate-300">
                                    <li>App.vue: Main application component</li>
                                    <li>style.css: Core CSS definitions and Tailwind directives</li>
                                    <li>wailsjs/: Auto-generated TypeScript bindings</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <section class="mt-8">
                    <h2><i class="fas fa-tools text-orange-500"></i> Build</h2>
                    <div class="card">
                        <p class="text-sm mb-3">Aviator uses Wails for compilation. Never use <code>go build</code>
                            directly.</p>
                        <div class="bg-slate-900 p-3 rounded border border-slate-700">
                            <code class="text-xs text-cyan-300">wails build</code>
                            <p class="text-xs text-slate-400 mt-2">Outputs to <code>build/bin/aviator-wails.exe</code>
                            </p>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
</body>

</html>
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aviator - Architecture</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="style.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Mermaid JS for diagrams -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'dark', flowchart: { useMaxWidth: false, htmlLabels: true } });
    </script>
</head>

<body class="min-h-screen flex">

    <!-- Sidebar -->
    <aside class="w-64 fixed h-full overflow-y-auto z-20">
        <div class="p-6 mb-4 text-center">
            <a href="index.html" class="block hover:opacity-80 transition-opacity">
                <h2
                    class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500 tracking-widest uppercase mb-1">
                    Aviator</h2>
                <p class="text-xs text-slate-500 font-mono">DOCS v2.4</p>
            </a>
        </div>
        <nav class="px-4 space-y-1">
            <a href="index.html" class="sidebar-link">Overview</a>
            <a href="manual.html" class="sidebar-link">User Manual</a>
            <a href="architecture.html" class="sidebar-link active">Architecture</a>
            <a href="api.html" class="sidebar-link">API Reference</a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="ml-64 p-12 w-full">
        <header class="mb-12">
            <h1>System Architecture</h1>
        </header>

        <section class="space-y-12">

            <!-- Overview -->
            <div>
                <h2>Overview</h2>
                <p>Aviator is a desktop application launcher built on <a href="https://wails.io/"
                        class="text-cyan-400">Wails</a>, combining a Go backend with a Vue.js frontend for the desktop
                    interface and a vanilla JS/HTML web interface for remote control.</p>
            </div>

            <!-- Component Diagram -->
            <div>
                <h2>Component Structure</h2>
                <div class="card bg-slate-900/50 flex justify-center py-8 overflow-x-auto">
                    <pre class="mermaid"
                        style="transform: scale(0.9); transform-origin: top center; min-height: 400px;">
graph TD
    Client[Client Device] -->|HTTP/REST| Server[Internal HTTP Server :8000]
    Desktop[Desktop UI] -->|Wails Bindings| App[Go Application Core]
    
    subgraph Backend [Go Runtime]
        App --> Server
        App --> ProcessMon[Process Monitor]
        App --> Config[Config Manager]
        App --> Launcher[Process Launcher]
        
        Server --> Config
        Server --> Launcher
        Server --> ProcessMon
    end
    
    subgraph Storage [Local File System]
        Config -->|Read/Write| JSON[config.json]
    end
                    </pre>
                </div>
            </div>

            <!-- modules -->
            <div>
                <h2>Core Modules</h2>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="card">
                        <h3 class="!mt-0 !mb-2 text-white">Application Core (app.go)</h3>
                        <ul class="list-disc list-inside space-y-1 text-slate-400 text-sm">
                            <li><strong>Lifecycle Management</strong>: Handles startup, shutdown, and window events.
                            </li>
                            <li><strong>Wails Bindings</strong>: Exposes Go methods to the frontend runtime.</li>
                            <li><strong>State Management</strong>: Maintains the state of the server and background
                                services.</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h3 class="!mt-0 !mb-2 text-white">HTTP Server (server.go)</h3>
                        <ul class="list-disc list-inside space-y-1 text-slate-400 text-sm">
                            <li><strong>Address</strong>: <code>0.0.0.0:8000</code></li>
                            <li><strong>Security</strong>: PIN-based auth, HttpOnly cookies.</li>
                            <li><strong>Static File Serving</strong>: Serves embedded <code>internal/web/static</code>.
                            </li>
                        </ul>
                    </div>

                    <div class="card">
                        <h3 class="!mt-0 !mb-2 text-white">Process Monitor</h3>
                        <ul class="list-disc list-inside space-y-1 text-slate-400 text-sm">
                            <li><strong>Mechanism</strong>: Polling (Window enumeration/Process list).</li>
                            <li><strong>Interval</strong>: 2 seconds.</li>
                            <li><strong>Integration</strong>: Updates status maps used by both Desktop and Web
                                consumers.</li>
                        </ul>
                    </div>

                    <div class="card">
                        <h3 class="!mt-0 !mb-2 text-white">Configuration</h3>
                        <ul class="list-disc list-inside space-y-1 text-slate-400 text-sm">
                            <li><strong>Path</strong>: <code>%LOCALAPPDATA%\Aviator\config.json</code>.</li>
                            <li><strong>Format</strong>: JSON array of app objects.</li>
                            <li><strong>Concurrency</strong>: Thread-safe reads/writes using mutexes.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Frontend Architecture -->
            <div>
                <h2>Frontend Architecture</h2>

                <h3 class="text-white mb-4">Desktop (Vue 3)</h3>
                <p class="text-slate-400 mb-4">Located in <code>frontend/src</code>. Uses Wails runtime for window
                    controls and backend communication.</p>
                <div class="card border-l-4 border-l-indigo-500">
                    <ul class="list-disc list-inside space-y-2 text-slate-300">
                        <li><code>App.vue</code>: Main layout and application logic.</li>
                        <li><code>style.css</code>: Tailwind CSS definitions and custom utilities.</li>
                    </ul>
                </div>

                <h3 class="text-white mb-4 mt-8">Web Dashboard (Vanilla JS)</h3>
                <p class="text-slate-400 mb-4">Located in <code>internal/web/static</code>. Lightweight, dependency-free
                    implementation for maximum mobile compatibility.</p>
                <div class="card border-l-4 border-l-cyan-500">
                    <ul class="list-disc list-inside space-y-2 text-slate-300">
                        <li><code>app.js</code>: Handles API interaction, polling, and UI state updates.</li>
                        <li><code>index.html</code>: Responsive layout with glassmorphism effects.</li>
                    </ul>
                </div>
            </div>

        </section>
    </main>
</body>

</html>